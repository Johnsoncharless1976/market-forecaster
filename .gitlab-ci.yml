# -------------------------------------------------------
# Stage 1.3 â€“ Daily Ingestion + Monitoring + Alerting
# -------------------------------------------------------
# Runs data_ingestion.py (Stage 1.3) once daily via schedule.
# If monitoring detects a failure, script exits 1 â†’ job fails â†’ CI/CD alert.
# Can also be run manually on main branch if needed.
#
# Commit Message:
# "Stage 1.3: GitLab CI/CD job for daily ingestion + monitoring + alerting"
# -------------------------------------------------------

stages:
  - ingest

daily_ingestion:
  stage: ingest
  script:
    - echo "ðŸš€ Running Stage 1.3 â€“ Ingestion + Monitoring + Alerting"
    - python src/data_ingestion.py
  rules:
    - if: '$CI_PIPELINE_SOURCE == "schedule"'
    - if: '$CI_COMMIT_BRANCH == "main"'
